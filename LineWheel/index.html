<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="main.css">
  <title>Spin Wheel</title>
</head>
<body>
<div align="center">
<h1> Win your prize for your purchase</h1>
</div>
<button class="button-71" role="button" onclick="openCase()">Spin</button>
<div id=unbox-area>
  <div class="arrow-down"></div>
  <div id=cardList></div>
</div>

<div id=dialog>
  <div id=dialog-msg></div>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script>var img = {
  blue: '<img src="gift.png"/>',
  purple: '<img src="purplegift.png"/>',
  pink: '<img src="pinkgift.png"/>',
  red: '<img src="redgift.png"/>',
  yellow: '<img src="yellowgift.png"/>'
}

function reset(){
  $('.card').remove();
  for (var i = 0; i < 210; i++){
    var element = '<div class="card" style="background-color: lightblue;" data-rarity="blue" id=itemNumber'+i+'>'+img.blue+'</div>';
    var rand = random(1,10000)/100;
    if (rand < 80){
      element = '<div class="card" style="background-color: purple;" data-rarity="purple" id=itemNumber'+i+'>'+img.purple+'</div>';
    }
    if (rand < 70){
      element = '<div class="card" style="background-color: hotpink;" data-rarity="pink" id=itemNumber'+i+'>'+img.pink+'</div>';
    }
    if (rand < 50){
      element = '<div class="card" style="background-color: red;" data-rarity="red" id=itemNumber'+i+'>'+img.red+'</div>';
    }
    if (rand < 40){
      element = '<div class="card" style="background-color: yellow;" data-rarity="yellow" id=itemNumber'+i+'>'+img.yellow+'</div>';
    }

    $('#cardList').append(element);
  }
  $('.card').first().css('margin-left',-1000);
}

function openCase(){
  reset();
  var rand = random(1000,20000);
  var childNumber = Math.floor(rand/200)+4;
  var timings = ["easeInOutBack","easeOutExpo","easeInOutBounce","easeOutQuad","swing","easeOutElastic","easeInOutElastic"];
  var timing = timings[4/*random(0,timings.length)*/];
  var reward = $('#itemNumber'+childNumber).attr('data-rarity');

  $('.card').first().animate({
    marginLeft: -rand
  }, 5000, timing, function(){

    var src = $('#itemNumber'+childNumber+' img').attr('src');
    open(reward);
  //   $('#itemNumber'+childNumber).css({background: "linear-gradient(#00bf09, #246b27)"});
  //
  //   $('#dialog-msg').html("You have received "+reward+" item!"+"<br><img src="+src+">");
  //
  //   $('#dialog').dialog({
  //     modal: true,
  //     title: "New item!",
  //     resizeable: false,
  //     draggable: false,
  //     width: 400,
  //     buttons: {
  //       "Receive item":function(){
  //         $(this).dialog("close");
  //         // add resources
  //       }
  //     }
  //   });
   });
  //$('.card').css({backgroundColor: 'red'})
  //$('.card:nth-child('+(childNumber+1)+')').css({backgroundColor: 'green'})
}
function open(reward){
  alert("You have won a " + reward+" reward! It will be added to your order!");
  window.close()
}
function random(min, max){
  return Math.floor((Math.random()*(max - min))+min);
}
</script>
</body>
</html>